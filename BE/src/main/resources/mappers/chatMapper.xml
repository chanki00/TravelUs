<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.DB_PASSWORD_REDACTED.trip.chat.mapper.ChatMapper">

  <select id="getNextChatId" resultType="int">
    SELECT IFNULL(MAX(chat_id), 0) + 1
    FROM chat
    WHERE chatroom_id = #{chatroomId}
  </select>

  <insert id="insertChatMessage">
    INSERT INTO chat (chatroom_id, chat_id, user_id, content, created_at)
    VALUES (#{chatroomId}, #{chatId}, #{userId}, #{content}, #{createdAt})
  </insert>

</mapper>
